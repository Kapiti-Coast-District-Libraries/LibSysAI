<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--DXMETADATA start type="MetaCharset" --><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8"><!--DXMETADATA end-->
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">

    <!--DXMETADATA start type="Literal" condition="helpversion:value=3" value="<meta name=""Microsoft.Help.SelfBranded"" content=""true"" />" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="ItemTitle" format="<title>%%ItemTitle%%</title>" --><title>Creating canned searches </title><!--DXMETADATA end-->
    <!--DXMETADATA start type="ItemTitle" format="<meta name=""Title"" content=""%%ItemTitleNoQuotes%%""/>" --><meta name="Title" content="Creating canned searches "/><!--DXMETADATA end-->
    
    <!--DXMETADATA start type="PackageLink" packagename="jquery" filetype="script" firstlinkattributes="id=""mshs_support_script"""--><script src="https://kapiti.spydus.co.nz/onlinehelp/template/packages/jquery/script/default/jquery.min.js" type="text/javascript" id="mshs_support_script"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="jquery-ui" filetype="script"--><script src="https://kapiti.spydus.co.nz/onlinehelp/template/packages/jquery-ui/script/default/jquery-ui.min.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="jquery-ui" filetype="css"--><link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/template/packages/jquery-ui/css/default/jquery-ui.min.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="TemplateSettingsJson" format="<script type=""text/javascript"">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:%%TemplateSettingsJson%%});</script>" --><script type="text/javascript">var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{isHideBodyDuringLoadDisabled:true,dynamictoc:{isEnabled:true},inthistopic:{isSupported:true},dynamicstyles:{isDynamicWordWrapEnabled:true}}},{settings:{"dynamictoc":{"initialNodeId":"n2258","initialNodeContainer":"c0","isResizable":true},"inthistopic":{"isEnabled":true},"darkmode":{"isEnabled":true},"currentLocale":"-","isFrameless":true,"navigationKind":"inpage","versions":{"locale":{"currentId":"-"}}}});</script><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="light" filetype="css"--><link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/template/packages/light/css/dynamic-toc.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="Synopsis" StripHtmlTags="True" MaxLength="250" format="<meta name=""Description"" content=""%%Synopsis%%"" />"--><meta name="Description" content="Search URLs can be created for use as hyperlinks in a static HTML page, for example to provide a list of DVDs held at a particular branch. As it is the search string which is saved, the results will always be up to date as the search is conducted fro" /><!--DXMETADATA end-->
    
    <!--DXMETADATA start type="PackageLink" packagename="plugins-topics" filetype="css"--><link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/template/packages/plugins-topics/css/default/jquery-plugins.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="core-topics" filetype="css" firstlinkattributes=" data-mshv2-stylesheet=""/template/packages/core-topics/topics.mshv2.css"" data-mshv1-stylesheet=""/template/packages/core-topics/topics.mshv1.css"" data-responsive-mobile=""template/packages/core-topics/topics.mobile.css"" data-responsive-tablet=""template/packages/core-topics/topics.tablet.css"""--><link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/template/packages/core-topics/css/topics.css"  data-mshv2-stylesheet="/template/packages/core-topics/topics.mshv2.css" data-mshv1-stylesheet="/template/packages/core-topics/topics.mshv1.css" data-responsive-mobile="template/packages/core-topics/topics.mobile.css" data-responsive-tablet="template/packages/core-topics/topics.tablet.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="plugins-topics" filetype="script"--><script src="https://kapiti.spydus.co.nz/onlinehelp/template/packages/plugins-topics/script/default/jquery-plugins.min.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="PackageLink" packagename="core-topics" filetype="script"--><script src="https://kapiti.spydus.co.nz/onlinehelp/template/packages/core-topics/script/topics.min.js" type="text/javascript"></script><!--DXMETADATA end-->
    
    <!--DXMETADATA start type="TopicId" format="<meta name=""Microsoft.Help.Id"" content=""%%TopicId%%""/>" --><meta name="Microsoft.Help.Id" content="0dea90bf-9a5e-4644-a25a-cfb760cce5f1"/><!--DXMETADATA end-->
    <!--DXMETADATA start type="TocParentId" format="<meta name=""Microsoft.Help.TocParent"" content=""%%TocParentId%%""/>" --><meta name="Microsoft.Help.TocParent" content="e6593cc0-f960-4e8c-bbdf-b73e33abd856"/><!--DXMETADATA end-->
    <!--DXMETADATA start type="TocOrdinal" format="<meta name=""Microsoft.Help.TocOrder"" content=""%%TocOrdinal%%""/>" --><meta name="Microsoft.Help.TocOrder" content="3"/><!--DXMETADATA end-->
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    <!--DXMETADATA start type="MshvKeywords" condition="helpversion:value=3" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="MshvMetaTags" condition="helpversion:value=3" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="Help3CatalogLocale" condition="helpversion:value=3" format="<meta name=""Microsoft.Help.Locale"" content=""%%Help3CatalogLocale%%"" />"--><!--DXMETADATA end-->
    <!--DXMETADATA start type="Help3CatalogLocale" condition="helpversion:value=3" format="<meta name=""Microsoft.Help.TopicLocale"" content=""%%Help3CatalogLocale%%"" />"--><!--DXMETADATA end-->
    <!--DXMETADATA start type="Stylesheets" --><link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/stylesheets/hs-heading-expandcollapse.css"></link>
    <link rel="stylesheet" type="text/css" href="https://kapiti.spydus.co.nz/onlinehelp/stylesheets/customstyles.css"></link><!--DXMETADATA end-->
    <!--DXMETADATA start type="StylePropertyValues" format="<style>%%StylePropertyValues%%</style>" --><style>.i-is-new .i-page-title-text::after, ul#i-dt-root li.i-is-new>a::after { content: "New" }
</style><!--DXMETADATA end-->
    <!--DXMETADATA start type="Scripts" --><script src="https://kapiti.spydus.co.nz/onlinehelp/script/hs-common.js" type="text/javascript"></script>
    <script src="https://kapiti.spydus.co.nz/onlinehelp/script/hs-heading-expandcollapse.js" type="text/javascript"></script>
    <script src="https://kapiti.spydus.co.nz/onlinehelp/scripts/headings-initially-collapsed.js" type="text/javascript"></script><!--DXMETADATA end-->
    <!--DXMETADATA start type="DesignTime"--><!--DXMETADATA end-->
    <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_PROPERTIES" --><!--DXMETADATA end -->
    <!--DXMETADATA start type="CanonicalLink" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="CustomHeadContent" --><!--DXMETADATA end-->
    <!--DXMETADATA start type="IsTemplateFileFeatureEnabled" name="DARKMODE" format="<meta name=""color-scheme"" content=""dark light"" />" --><meta name="color-scheme" content="dark light" /><!--DXMETADATA end-->
	
    <script type="text/javascript">
        try
        {
            window.addEventListener('load', function() {
                if (location.hash) location.href = location.hash;
            });
        }
        catch (e) { }
        finally {}
    </script>
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content">
        
    </div>

    <div id="i-header-container">
        <div id="i-header-content" class="i-header-content i-content-width-container">
            <!--DXMETADATA start type="LogoImage" --><!--DXMETADATA end-->
            <div class="i-project-title"><!--DXMETADATA start type="ProjectTitle" -->Spydus Help<!--DXMETADATA end--></div>
            <div class="i-flex-spacer"></div>
            <div class="i-header-buttons-container">
                <div class="i-search-container">
                    <!--DXMETADATA start type="outputfileextension" format="<form action=""websearch%%outputfileextension%%"">" --><form action="https://kapiti.spydus.co.nz/onlinehelp/websearch.html"><!--DXMETADATA end-->
                    <!--DXMETADATA start type="Phrase" name="SEARCH_OPERATORTIP" format="<input id=""i-search"" name=""query"" title=""%%phrase%%""/>" --><input id="i-search" name="query" title="(Words can be combined using OR and AND)"/><!--DXMETADATA end-->
                    <input type="submit" id="i-search-button" value="" />
                    <!--DXMETADATA start type="Literal" value="</form>" --></form><!--DXMETADATA end-->
                </div>
                <!--DXMETADATA start type="outputfileextension" format="<a id=""i-index-button"" href=""webindex%%outputfileextension%%""></a>" --><a id="i-index-button" href="https://kapiti.spydus.co.nz/onlinehelp/webindex.html"></a><!--DXMETADATA end-->
            </div>
        </div>
    </div>
    
    <div class="i-content-width-container"><div class="i-busy-overlay"></div></div>

    <div id="i-breadcrumbs-outer-container" class="i-content-width-container"><!--DXMETADATA start type="Breadcrumbs" scrap="_BREADCRUMBS" --><div class="i-breadcrumbs-container">
<a href="Factsheets.html">Factsheets </a>
 / Creating canned searches </div><!--DXMETADATA end --></div>

    

    <div id="i-actions-outer-container" class="i-content-width-container">
        <div id="i-actions-container">
            <div id="i-actions-content" class="i-fixed-to-top">
                <!-- Spacing --> <span class="i-toggle-all-sections i-function-link">
                <label class="i-collapse-all"><!--DXMETADATA start type="Phrase" name="COLLAPSE_ALL" -->Collapse All<!--DXMETADATA end--></label>
                <label class="i-expand-all" style="display: none;"><!--DXMETADATA start type="Phrase" name="EXPAND_ALL" -->Expand All<!--DXMETADATA end--></label>
            </span><!--DXMETADATA start type="Literal" condition="communityenabled" value="%%scrap:name=_COMMUNITY_DROPDOWN%%" --><!--DXMETADATA end -->
                <div class="i-in-this-topic-container">
                    <span class="i-action-group-heading"><!--DXMETADATA start type="Phrase" Name="IN_THIS_TOPIC" -->In This Topic<!--DXMETADATA end--></span>
                </div>
            </div>
        </div>
    </div>

    <div id="i-toc-outer-container" class="i-content-width-container">
        <div id="i-toc-container">
            <div id="i-toc-content" class="i-fixed-to-top">
                <div class="i-toc-content-scroll-container">
                    <div id="i-dynamic-toc-container"><ul id="i-dt-root"></ul></div>
                </div>
            </div>
        </div>
    </div>

    <div id="i-body-content-container" class="i-content-width-container">
        <div id="i-body-content" class="i-body-content">
            <div class="i-page-title"><div class="i-page-title-text"><!--DXMETADATA start type="ItemTitle" -->Creating canned searches <!--DXMETADATA end--></div></div>
            <div class="i-in-this-topic-container">
                <span class="i-action-group-heading"><!--DXMETADATA start type="Phrase" Name="IN_THIS_TOPIC" -->In This Topic<!--DXMETADATA end--></span>
            </div>
            <!--DXMETADATA start type="TopicSection" name="BodyText"--><P>Search URLs can be created for use as hyperlinks in a static HTML page, for example to provide a list of DVDs held at a particular branch. As it is the search string which is saved, the results will always be up to date as the search is conducted from scratch every time. There are a number of elements that make up the search string. This factsheet&nbsp;aims to explain each of these elements and how they can be used. Once the first&nbsp;URL has been constructed and tested, it is an easy process to copy and modify that string (e.g. change location or collection).&nbsp;</P>
<P>The completed strings can then be used as a hyperlink in an HTML document. A link to this document can be added to the OPAC, for example in the side navigation frame. The searches discussed below are based on the options available in the Advanced Search screen.</P>
<H1>Building a URL with search items</H1>
<P>As a first example, we will look at building a URL which will conduct a title and author keyword search.</P>
<P>The URL for a title keyword search for records on Australian Frogs by Michael Tyler is:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>http://localhost/cgi-bin/spydus.exe/ENQ/OPAC/BIBENQ?ENTRY1_NAME=AU&amp;ENTRY1=Tyler+Michael&amp;ENTRY1_TYPE=K&amp;ENTRY1_OPER=%2BENTRY2_NAME=TI&amp;ENTRY2=Australian+Frogs&amp;ENTRY2_TYPE=K&amp;NRECS=100&amp;SORTS=HBT.SOVR&amp;CF=GEN&amp;SEARCH_FORM=%2Fcgi-bin%2Fspydus.exe%2FMSG%2FOPAC%2FCOMB.HTM&amp;QRY=</P></BLOCKQUOTE>
<P>This URL is made up of a number of elements concatenated by "&amp;".</P>
<TABLE>
<TBODY>
<TR>
<TD>http://localhost/cgi-bin/spydus.exe/ENQ/OPAC/BIBENQ?</TD>
<TD>URL of OPAC and enquiry parameters. Replace localhost with your server name.</TD></TR>
<TR>
<TD>ENTRY1_NAME=AU</TD>
<TD>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">First enquiry term type</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">TI = Title</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">AU = Author</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">SU = Subject</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">SE = Series title</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">BS = Anywhere</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">PU = Publisher</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">NTS = General notes</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">AB = Abstract</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">JT = Periodical title Classification code 1 (see below)</P></TD></TR>
<TR>
<TD>&amp;ENTRY1=Tyler+Michael</TD>
<TD>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">Text for search (use + in place of spaces)</P></TD></TR>
<TR>
<TD>&amp;ENTRY1_TYPE=K</TD>
<TD>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">&nbsp;Search type K = keyword A = phrase E = exact match.</P></TD></TR>
<TR>
<TD>&amp;ENTRY1_OPER=%2B (for searches using more than one term)</TD>
<TD>Four search terms can be used (ENTRY1 – ENTRY4). Between each pair of terms a Boolean operator is required, entered in the ASCII Hex equivalent: %2B = + (and) %2D = - (not) %2F = / (or)</TD></TR>
<TR>
<TD>BENTRY2_NAME=TI&amp;ENTRY2=Australian+Frogs&amp;ENTRY2_TYPE=K</TD>
<TD>Second enquiry term, type, text and search type as above</TD></TR>
<TR>
<TD>&amp;NRECS=100</TD>
<TD>Number of brief records per page</TD></TR>
<TR>
<TD>&amp;SORTS=HBT.SOVR</TD>
<TD>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">Sort order for brief display&nbsp;</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">HBT.SOVR = Title</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">DTE.DATE1.DESC%5DHBT.SOVR = Publication Date, latest to earliest</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">DTE.DATE1%5DHBT.SOVR = Publication Date, earliest to latest</P>
<P class=MsoNormal style="MARGIN-LEFT: 0cm">SQL_AUTHOR_TITLE = Author by Title</P></TD></TR>
<TR>
<TD>&amp;CF=GEN</TD>
<TD>Filter set. Collections which can be viewed in the OPAC have a filter set of GEN. Others filters may also be used such as PIC where this has been assigned to a pictorial collection.</TD></TR>
<TR>
<TD>&amp;SEARCH_FORM=%2Fcgi-bin%2Fspydus.exe%2FMSG%2FOPAC%2FCOMB.HTM&amp;QRY=</TD>
<TD>Returns the browser to the Quickfind page with an empty search filed when the new search icon is clicked</TD></TR></TBODY></TABLE>
<H1>Using publication date in the search</H1>
<P>The code for publication date is PD. For 'before' or 'after' searches use the ASCII Hex equivalent of &lt; or &gt;.</P>
<BLOCKQUOTE class=CourierNew dir=ltr>
<P>3C = &lt;</P>
<P>3E = &gt;</P></BLOCKQUOTE>
<P>For example:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>http://localhost/cgi-bin/spydus.exe/ENQ/OPAC/BIBENQ?PD=2006&amp;NRECS=100&amp;SORTS=HBT.SOVR&amp;CF=GEN&amp;SEARCH_FORM=%2Fcgi-bin%2Fspydus.exe%2FMSG%2FOPAC%2FCOMB.HTM&amp;QRY=</P></BLOCKQUOTE>
<P>Year ranges are entered with a "-" between the years, for example:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>PD=2012-2014</P>
<P class=CourierNew>PD=%3C2014 (&lt;2014)</P>
<P class=CourierNew>PD=%3E20014(&gt;2014)&nbsp;</P></BLOCKQUOTE>
<H1>Collection and location searches</H1>
<P>The location and collection queries use the IRN for the search and a description for the display in the results window. The format used is a combination of Location IRN and Collection IRN followed by the Description (after an *) as one element of the search string. If Location is used to limit the search, then the syntax is:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>LOC=1234_%25*Centreville+Branch</P></BLOCKQUOTE>
<P>where 1234 is the Location IRN and %25 represents the % or SQL wild card character. The results page will have a heading <STRONG>Location: Centreville Branch</STRONG>.</P>
<P>If Collection is used to limit the search, the syntax is:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>CLN=%25_5678*DVD</P></BLOCKQUOTE>
<P>where 5678 is the Collection IRN. The results page will have a heading <STRONG>Collection: Junior Fiction</STRONG>. It is possible to combine the Location and Collection in the one element of the search string, for example:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>LOC=1234_5678-Centreville+Branch</P></BLOCKQUOTE>
<P>However only&nbsp;one description can be entered so the results page will have the heading <STRONG>Location: Centreville Branch</STRONG> even if the set is limited to the records with items in the Junior Fiction collection. To display both descriptions in the heading, the syntax would be:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>LOC=1234_%25*Centreville+Branch&amp; CLN=%25_5678*DVD</P></BLOCKQUOTE>
<P>which will give a heading <STRONG>Location:Centreville Branch and Collection DVD</STRONG>.</P>
<P>The complete URL will be:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>http://localhost/cgi-bin/spydus.exe/ENQ/OPAC/BIBENQ? LOC=1234_%25*Centreville+Branch&amp;CLN=%25_5678*DVD NRECS=100&amp;SORTS=HBT.SOVR&amp;CF=GEN&amp; SEARCH_FORM=%2Fcgi-bin%2Fspydus.exe%2FMSG%2FOPAC%2FCOMB.HTM&amp;QRY=</P></BLOCKQUOTE>
<H1>Using BRN in a search</H1>
<P>You may want to create a hyperlink to a specific record (e.g. an image). The best way is to link to the BRN (rather than title, for example).</P>
<P>The URL for this would be:</P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P class=CourierNew>http://localhost/cgi-bin/spydus.exe/ENQ/OPAC/BIBENQ?CF=PIC&amp;BRN=9999</P></BLOCKQUOTE>
<P>CF=PIC assumes a separate collection filter is used for this collection, otherwise use CF=GEN.</P>
<H1>Class number searches</H1>
<P>DDC = Dewey class.</P>
<P>CAL = LC class.</P>
<P>MYC = Moys class.</P>
<P>LXC = Local class.</P>
<P>CNO = Call number.</P>
<P>SBN = ISBN.</P>
<P>SSN = ISSN.</P>
<H1>Notes</H1>
<P>If only a few results are expected (as may be the case where a title search is used) then the NRECS and SORTS won't be required.</P>
<P>Use + for spaces.</P>
<P>Use &amp; (and) to join search criteria.</P>
<P>'%' precedes an ASCII Hex code.</P>
<P>2F = /</P>
<P>5D = ]</P>
<P>25 = % (SQL wild card)</P>
<P>2B = +</P><!--DXMETADATA end-->
            <a name="seealsobookmark"></a>
            <!--DXMETADATA start type="FilteredItemList" scrap="CATEGORISED_LINKS" namespace="linkcategory" source="Item" filter="" NoHeader="True" NoFooter="True" format="%%replaceinquotes:value=false%%%%scrap:name=_COLLAPSIBLE_HEADER,idprefix=seealso,caption=""%%phrase:name=SeeAlso%%%%designlist:tagidentifier=seealso,itemtype=See Also%%""%%%%filtereditemlist%%</div>"--><!--DXMETADATA end-->
            
            <div id="i-footer-content" class="i-footer-content">
                <!--DXMETADATA start type="Scrap" condition="communityenabled" name="_COMMUNITY_FOOTER" --><!--DXMETADATA end -->
<!--DXMETADATA start type="Variable" name="CopyrightNotice" format="<p>&nbsp;</p><p>&nbsp;</p><hr style=""height: 1px"" /><p>%%variable%%</p>" --><p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p>© Civica Pty Ltd 2025. All rights reserved   |   Version: 2025R1</p><!--DXMETADATA end -->
<!--DXMETADATA start type="Variable" name="FeedbackLink" format="" --><!--DXMETADATA end-->
            </div>
        </div>
    </div>
        
    <script type="text/javascript">
        $(function () {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.load();
        });
    </script>
</body>
</html>

